<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/x-icon" href="assets/imagens/logo3.png" />
  <link rel="stylesheet" href="./css/login.css" />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
    rel="stylesheet" />
  <title>Cadastrar</title>
</head>

<body>
  <a href="index.html"><img class="btnvoltar"
      src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAC10lEQVR4nO3bP09TURjH8e+5iNaSOJj4AhyMA5WJxWgi6oQBE4uwOJkYMM6+AN6AawPEwcRRYACMk8qiDrJocDDxBTiZGGIpNr3HATEY/+Tctrfn3J7fZ+1t8uT55vaWXi6IiIiIiIiIiIiIiIiIiIiIiIhIVxnfA3TL9srdCxZzCYDUbJ6brr32PJKTwgfYWp8tl/YGHmNs9bcXrFkd2tm9dfr2o4an0ZwkvgfoxNb6bLn03Wz8sXwAY6vfTpQeeBgrk8KeAb+Wj7n8n8OajVZ6anRm6WvPBsuokGeA4/IBBo8PJmd7MlSbChcgw/L3NZMvOY/UkUIFyLx8eDc8U/uU61AdKkyANpZft9beyXWoLjjiewAX+8tP1gHn5RvDZGVqcSvPuboh+G9Bh5Z/xfEtdWOYHK4uvMhzrm4JOkC/Lx8CDhDD8iHQALEsHwIMENPyIbAAsS0fAgoQ4/IhkACxLh8CCBDz8sFzgNiXDx4DaPn7vPwYZ+fnk9JeskyG5UMy0W/LB08Btkc+X8Mw7nh4HZKJylTtZa5DeeLl11Bj7UXHT7+fHzv9uXzwdT/AGOt8bMt6/6aWJz/XAHjleGjZJmZte+We632AwvESoHJj4SmWZ46HlyHd6NcIXgIYg20cS29ieO74ljKkGx+ezF3NdTAP/P8h1kzWsLgutm5Se314etE1XPC8X+Bij+A9AMQdIYgAEG+EYAJAnBGCCgDxRQguAMQVIcgAEE+EYANAHBGCDgD9HyH4ANDfEQoRANr793RIxipTtbe5DtahwjwfMDq5VG8ctRNgXW/OlCF9mOtQXVCYM+BA1jPBtJIzIT8lU5gz4EDmM2EwPZnzSB0pXADIFKG520w/9mSoNhUyADhGsHYp5GeEocAB4HAEVv7y8vLQzt79Xs+UVeEuwv/yfnXu/IBlDKBl2BypLr7xPZOIiIiIiIiIiIiIiIiIiIiIiIh48APCDWrMdX6GhQAAAABJRU5ErkJggg==" /></a>
  <section>
    <div class="loginarea">
      <div class="container">
        <div class="cont">
          <h1>
            <img class="logo" width="200px" src="assets/imagens/logo2.png" alt="LOGO" />
          </h1>
        </div>
        <p>Use seu email para se cadastrar</p>
        <input type="text" id="inptEmail" />
        <div id="errorEmail"></div>
        <p>Crie uma senha</p>
        <input type="password" id="inptSenha" />
        <label id="errorSenha"></label>
        Confirme sua senha
        <input type="password" id="inptCsenha" />
        <label id="errorCSenha"></label>
        <button class="btnLogin" onclick="cadastrar()">Cadastrar</button>
        <p>Já possui uma conta?<a href="login.html"> faça login aqui!</a></p>
      </div>
    </div>
    <div class="canvalogin">
      <img src="http://localhost:3333/assets/imagens/Site%20Stats-amico.svg" alt="" />
    </div>
    <div class="footerLogin">
      <p>© 2022 Empresa, Inc, Todos os direitos reservados</p>
      <a href="#">Suporte</a>
    </div>
  </section>
</body>

</html>

<script>
  function cadastrar() {
    var emailVar = inptEmail.value;
    var senhaVar = inptSenha.value;
    var confirmacaoSenhaVar = inptCsenha.value;

    errorEmail.innerHTML = `<p> </p>`;
    errorSenha.innerHTML = `<p> </p>`;
    errorCSenha.innerHTML = `<p> </p>`;

    if (emailVar == "" && senhaVar == "" && confirmacaoSenhaVar == "") {
      errorEmail.innerHTML = `<p style="color: red;"> Todos os campos são necessários</p>`;
      errorSenha.innerHTML = `<p style="color: red;"> Todos os campos são necessários</p>`;
      errorCSenha.innerHTML = `<p style="color: red;"> Todos os campos são necessários</p>`;
      return false;
    } else if (emailVar.indexOf("@") == -1 || emailVar.indexOf(".com") == -1) {
      errorEmail.innerHTML = `<p style="color: red;">Ops, e-mail inválido! Verifique e tente novamente.`;
      return false;
    } else if (senhaVar != confirmacaoSenhaVar) {
      errorCSenha.innerHTML = `<p style="color: red;">As senhas inseridas devem ser iguais para prosseguir!`;
      return false;
    } else {
      location.href = "login.html";
    }

    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        email: emailVar,
        senha: senhaVar,
      }),
    }).then(function (resposta) {
      console.log("resposta: ", resposta);
      if (resposta.ok) {
        console.log("chegou aqui");
        alert(
          "Cadastro realizado com sucesso! Redirecionando para tela de Login...",
        );
        setTimeout(() => {
          window.location = "./login.html";
        }, "1000");
      } else {
        throw "Houve um erro ao tentar realizar o cadastro!";
        return false;
      }
    });
  }
</script>